
### 업무 식별자
---
엔티티의 유일성을 보장해주는 것이 식별자이다.

업무 식별자는 업무적으로 엔티티 인스턴스 구분하게 하는 식별자.

물리적으로 인스턴스를 구분하게 하는 식별자는 주 식별자(Primary Identifier)다.

### **예제로 보는 업무 식별자**

>**Note**
> (α) 학교 데이터베이스 커스텀 예제로 책과 다름.

데이터베이스 구조

학교에서 학생, 강의, 그리고 강의 등록 정보를 관리하는 시스템을 구축하는 경우.

**1. 학생 테이블 (`Students`)**

|학번 (PK)|이름|<u>주민번호 (업무 식별자)</u>|학년|전공|
|---|---|---|---|---|
|1001|김철수|920101-1234567|2|컴퓨터공학|
|1002|이영희|910506-2234567|3|경영학|

>**Note**
> 학생 테이블을 관리하는 주 식별자(PK)는 학번이 일반적임. \
> 위와 같이 주민번호가 업무 식별자 라면 (일반적으로 언더라인). \
> 학생의 주민번호가 같다면 새로운 사원으로 인식하지 않겠다는 것을 의미. \
> 동일한 주민번호를 가진 학생이 다시 입학하는 경우, 새로운 학번을 받아도 주민번호는 같음. \
> 즉 새로운 인스턴스가 추가되는 기준은 학생의 주민등록 번호 속성임.

>**Important**
>학번으로 엔티티의 유일성을 식별할 수 는 있지만, 엔티티의 인스턴스를 늘리는 데 영향력이 없다.

**재입학 학생 관리**

학생이 휴학 후 재입학하는 경우, 동일한 주민번호를 가진 학생에게 새로운 학번을 부여하는 경우.

**`Students` 테이블**

|학번 (PK)|이름|<u>주민번호(업무식별자)</u>|학년|전공|<u>입학일자(업무 식별자)</u>|휴학일자|졸업일자|
|---|---|---|---|---|---|---|---|
|1001|김철수|920101-1234567|2|컴퓨터공학|2019-03-01|2020-02-28|NULL|
|1003|김철수|920101-1234567|1|정보통신학|2022-03-01|NULL|NULL|

해당 경우에는 입학일자와 주민번호가 업무식별자가 된다.

만약 같은 학번을 제공한다고 가정한다면.

**`Students` 테이블**

|학번 (PK)|이름|주민번호|학년|전공|
|---|---|---|---|---|
|1001|김철수|920101-1234567|2|컴퓨터공학|

**`StudentHistory` 테이블**

|이력ID (PK)|학번 (FK)|상태|시작일자|종료일자|
|---|---|---|---|---|
|1|1001|입학|2019-03-01|2020-02-28|
|2|1001|휴학|2020-03-01|2022-02-28|
|3|1001|재입학|2022-03-01|NULL|

위와 같이 별도의 이력관리 테이블을 두어서 해당 학번을 다시 할당해줄 수도 있다.

>**Warning**
>한사람에게 여러가지 학번이 존재하는 것은 바람직하지 않다.

### 엔티티가 종속 엔티티 일때.

엔티티가 종속 엔티티일 때 엄무 식별자가 애매해질 수 있다.

학생마다 주소가 존재.

학생 테이블

| 학번 | 이름 | 학과 | 
| --- | --- | --- | 
| 20230001 | 김철수 | 컴퓨터과학 | 
| 20230002 | 이영희 | 경영학 |

주소 테이블

주 식별자는 학번 + 주소 순번

업무 식별자는 학번 + 주소 유형

| # 학번 | # 주소순번 | 주소유형 | 주소 |
| --- | --- | --- | --- | 
| 20230001 | 1 | 집 | 서울시 중구 OO동 | 
| 20230001 | 2 | 기숙사 | 서울시 강남구 XX동 | 
| 20230002 | 1 | 집 | 서울시 서초구 YY동 |

>**Warning**
>하지만 위에서 사용한 주소 순번은 인조 식별자임. \
>부분 주 식별자로 ~ 순번 과같은 인조 식별자가 사용되면 업무를 알 수 없게 되며 인스턴스를 생성하는 기준 또한 알수 없게 되기 때문에 바람직 하지 않음.

| # 학번 |# 주소유형 | 주소 |
| --- | --- | --- | 
| 20230001 | 집 | 서울시 중구 OO동 | 
| 20230001 | 기숙사 | 서울시 강남구 XX동 | 
| 20230002 | 집 | 서울시 서초구 YY동 |

위 와 같이 업무 식별자만으로 주 식별자를 사용하거나.

>**Note**
>주소유형코드를 식별자로 넣었을 때 업무-주 식별자가 일치. \
>주소유형코드는 부분 주 식별자(Partial Primary Identifier) 라고 함

|# 학생 주소 번호| 학번 | 주소유형 | 주소 |
| --- | --- | --- | --- | 
|1| 20230001 | 집 | 서울시 중구 OO동 | 
|2| 20230001 | 기숙사 | 서울시 강남구 XX동 | 
|3| 20230002 | 집 | 서울시 서초구 YY동 |

위와 같이 인조 식별자(학생 주소 번호) 만으로 주 식별자를 사용 해야함.

순번 외 주소유형코드를 식별자로 넣었을 때 업무-주 식별자가 일치

주소유형코드는 부분 주 식별자(Partial Primary Identifier) 라고 함

#### 업무 식별자가 되기 위한 조건
---

유일한 값을 가지고 있어야 함

널을 허용하면 안됨

수정되지 않는게 기본 원칙

인스턴스를 발생시키는 값이며

수정되었을 시 외래 식별자(자식 엔티티)의 값에 영향을 미치므로 변경하지 않는 것이 원칙.


#### 생성 요령
---

어떤 데이터를 관리 할 것인지 정한다

어떤 기준으로 데이터가 생성되는지 정한다

고객을 "인격체"로 정의하면 업무식별자는 주민번호

고객을 "인격체 + 역할" 로 정의하면 업무식별자는 주민번호+고객유형
